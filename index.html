<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gifts Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 100%;
            padding: 15px;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .balance {
            background-color: #fff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .menu {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        .menu-button {
            background-color: #fff;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        .menu-button:hover {
            background-color: #f0f0f0;
        }
        .section {
            background-color: #fff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .back-button {
            background-color: #f0f0f0;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            margin-top: 10px;
            cursor: pointer;
        }
        .payment-method {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
        .payment-method:last-child {
            border-bottom: none;
        }
        .payment-icon {
            margin-right: 10px;
            font-size: 20px;
        }
        .input-amount {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .submit-button {
            background-color: #007aff;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px;
            width: 100%;
            cursor: pointer;
        }
        .error {
            color: red;
            margin-bottom: 10px;
        }
        .gift-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .gift-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="main-screen">
            <div class="header">
                <h2>üéÅ Gifts Mini App</h2>
            </div>
            <div class="balance">
                <h3>–í–∞—à –±–∞–ª–∞–Ω—Å: <span id="balance">0</span> üíé</h3>
            </div>
            <div class="menu">
                <div class="menu-button" onclick="showGames()">
                    üéÆ –ú–∏–Ω–∏-–∏–≥—Ä—ã
                </div>
                <div class="menu-button" onclick="showProfile()">
                    üë§ –ü—Ä–æ—Ñ–∏–ª—å
                </div>
                <div class="menu-button" onclick="showDeposit()">
                    üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å
                </div>
                <div class="menu-button" onclick="showInventory()">
                    üéÅ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –º–∏–Ω–∏-–∏–≥—Ä -->
        <div id="games-screen" style="display: none;">
            <div class="section">
                <h3>üéÆ –ú–∏–Ω–∏-–∏–≥—Ä—ã</h3>
                <div class="menu-button" onclick="showUpgradeGifts()">
                    üéÅ –ê–ø–≥—Ä–µ–π–¥ –ø–æ–¥–∞—Ä–∫–æ–≤
                </div>
                <div class="menu-button" onclick="showCases()">
                    üé≤ –ö–µ–π—Å—ã
                </div>
                <div class="menu-button" onclick="showRoulette()">
                    üé° –†—É–ª–µ—Ç–∫–∞
                </div>
                <div class="back-button" onclick="backToMain()">
                    üîô –ù–∞–∑–∞–¥
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ -->
        <div id="deposit-screen" style="display: none;">
            <div class="section">
                <h3>üíé –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞</h3>
                <p>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:</p>
                <div class="payment-method" onclick="showTonPayment()">
                    <div class="payment-icon">üí∞</div>
                    <div>TON Wallet</div>
                </div>
                <div class="back-button" onclick="backToMain()">
                    üîô –ù–∞–∑–∞–¥
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ TON -->
        <div id="ton-payment-screen" style="display: none;">
            <div class="section">
                <h3>üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ TON</h3>
                <p>–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤ –∞–ª–º–∞–∑–∞—Ö:</p>
                <input type="number" id="ton-amount" class="input-amount" placeholder="100">
                <div id="ton-error" class="error"></div>
                <button class="submit-button" onclick="processTonPayment()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
                <div class="back-button" onclick="backToDeposit()">
                    üîô –ù–∞–∑–∞–¥
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∞–ø–≥—Ä–µ–π–¥–∞ –ø–æ–¥–∞—Ä–∫–æ–≤ -->
        <div id="upgrade-gifts-screen" style="display: none;">
            <div class="section">
                <h3>üéÅ –ê–ø–≥—Ä–µ–π–¥ –ø–æ–¥–∞—Ä–∫–æ–≤</h3>
                <div id="gifts-list"></div>
                <div class="back-button" onclick="backToGames()">
                    üîô –ù–∞–∑–∞–¥
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∫–µ–π—Å–æ–≤ -->
        <div id="cases-screen" style="display: none;">
            <div class="section">
                <h3>üé≤ –ö–µ–π—Å—ã</h3>
                <div class="menu-button" onclick="openCase(100)">
                    –û–±—ã—á–Ω—ã–π –∫–µ–π—Å (100 üíé)
                </div>
                <div class="menu-button" onclick="openCase(500)">
                    –†–µ–¥–∫–∏–π –∫–µ–π—Å (500 üíé)
                </div>
                <div class="menu-button" onclick="openCase(2000)">
                    –≠–ø–∏—á–µ—Å–∫–∏–π –∫–µ–π—Å (2000 üíé)
                </div>
                <div class="back-button" onclick="backToGames()">
                    üîô –ù–∞–∑–∞–¥
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Ä—É–ª–µ—Ç–∫–∏ -->
        <div id="roulette-screen" style="display: none;">
            <div class="section">
                <h3>üé° –†—É–ª–µ—Ç–∫–∞</h3>
                <div class="menu-button" onclick="playRoulette(100)">
                    –û–±—ã—á–Ω–∞—è —Ä—É–ª–µ—Ç–∫–∞ (100 üíé)
                </div>
                <div class="menu-button" onclick="playRoulette(500)">
                    –†–µ–¥–∫–∞—è —Ä—É–ª–µ—Ç–∫–∞ (500 üíé)
                </div>
                <div class="menu-button" onclick="playRoulette(5000, true)">
                    –°—É–ø–µ—Ä —Ä—É–ª–µ—Ç–∫–∞ (5 TON)
                </div>
                <div class="back-button" onclick="backToGames()">
                    üîô –ù–∞–∑–∞–¥
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile-screen" style="display: none;">
            <div class="section">
                <h3>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h3>
                <p>ID: <span id="user-id"></span></p>
                <p>–ò–º—è: <span id="username"></span></p>
                <p>–ë–∞–ª–∞–Ω—Å: <span id="profile-balance"></span> üíé</p>
                <div class="back-button" onclick="backToMain()">
                    üîô –ù–∞–∑–∞–¥
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è -->
        <div id="inventory-screen" style="display: none;">
            <div class="section">
                <h3>üéÅ –í–∞—à–∏ –ø–æ–¥–∞—Ä–∫–∏</h3>
                <div id="inventory-list"></div>
                <div class="back-button" onclick="backToMain()">
                    üîô –ù–∞–∑–∞–¥
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();

        // –ò–º–∏—Ç–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        let userData = {
            userId: tg.initDataUnsafe.user?.id || 123456789,
            username: tg.initDataUnsafe.user?.username || 'User',
            balance: 1000,
            inventory: [
                { id: 1, name: "–û–±—ã—á–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫", value: 100, quantity: 5 },
                { id: 2, name: "–†–µ–¥–∫–∏–π –ø–æ–¥–∞—Ä–æ–∫", value: 500, quantity: 2 }
            ]
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentScreen = 'main';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            updateBalance();
            document.getElementById('user-id').textContent = userData.userId;
            document.getElementById('username').textContent = userData.username;
            document.getElementById('profile-balance').textContent = userData.balance;
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
        function updateBalance() {
            document.getElementById('balance').textContent = userData.balance;
            document.getElementById('profile-balance').textContent = userData.balance;
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —ç–∫—Ä–∞–Ω–∞–º
        function showScreen(screen) {
            document.getElementById(`${currentScreen}-screen`).style.display = 'none';
            document.getElementById(`${screen}-screen`).style.display = 'block';
            currentScreen = screen;
        }

        function backToMain() {
            showScreen('main');
        }

        function backToGames() {
            showScreen('games');
        }

        function backToDeposit() {
            showScreen('deposit');
        }

        function showGames() {
            showScreen('games');
        }

        function showProfile() {
            showScreen('profile');
        }

        function showDeposit() {
            showScreen('deposit');
        }

        function showInventory() {
            renderInventory();
            showScreen('inventory');
        }

        function showTonPayment() {
            showScreen('ton-payment');
        }

        function showUpgradeGifts() {
            renderGifts();
            showScreen('upgrade-gifts');
        }

        function showCases() {
            showScreen('cases');
        }

        function showRoulette() {
            showScreen('roulette');
        }

        // –†–µ–Ω–¥–µ—Ä –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function renderInventory() {
            const inventoryList = document.getElementById('inventory-list');
            inventoryList.innerHTML = '';

            if (userData.inventory.length === 0) {
                inventoryList.innerHTML = '<p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–¥–∞—Ä–∫–æ–≤</p>';
                return;
            }

            userData.inventory.forEach(item => {
                const div = document.createElement('div');
                div.className = 'gift-item';
                div.innerHTML = `
                    <div>${item.name} (${item.value} üíé)</div>
                    <div>x${item.quantity}</div>
                `;
                inventoryList.appendChild(div);
            });
        }

        // –†–µ–Ω–¥–µ—Ä –ø–æ–¥–∞—Ä–∫–æ–≤ –¥–ª—è –∞–ø–≥—Ä–µ–π–¥–∞
        function renderGifts() {
            const giftsList = document.getElementById('gifts-list');
            giftsList.innerHTML = '';

            if (userData.inventory.length === 0) {
                giftsList.innerHTML = '<p>–£ –≤–∞—Å –Ω–µ—Ç –ø–æ–¥–∞—Ä–∫–æ–≤ –¥–ª—è –∞–ø–≥—Ä–µ–π–¥–∞</p>';
                return;
            }

            userData.inventory.forEach(item => {
                const div = document.createElement('div');
                div.className = 'menu-button';
                div.innerHTML = `
                    ${item.name} (–¶–µ–Ω–Ω–æ—Å—Ç—å: ${item.value} üíé)
                `;
                div.onclick = function() {
                    upgradeGift(item.id);
                };
                giftsList.appendChild(div);
            });
        }

        // –ê–ø–≥—Ä–µ–π–¥ –ø–æ–¥–∞—Ä–∫–∞
        function upgradeGift(giftId) {
            const gift = userData.inventory.find(item => item.id === giftId);
            if (!gift) return;

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ 3 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø–æ–¥–∞—Ä–∫–∞
            if (gift.quantity < 3) {
                alert(`–î–ª—è –∞–ø–≥—Ä–µ–π–¥–∞ –Ω—É–∂–Ω–æ 3 ${gift.name.toLowerCase()}. –£ –≤–∞—Å —Ç–æ–ª—å–∫–æ ${gift.quantity}.`);
                return;
            }

            // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
            gift.quantity -= 3;

            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ø–æ–¥–∞—Ä–æ–∫ —Å –±–æ–ª—å—à–µ–π —Ü–µ–Ω–Ω–æ—Å—Ç—å—é
            let newGiftValue;
            switch (gift.value) {
                case 100: newGiftValue = 500; break;
                case 500: newGiftValue = 2000; break;
                case 2000: newGiftValue = 5000; break;
                default:
                    // –ï—Å–ª–∏ —ç—Ç–æ —É–∂–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∞–ª–º–∞–∑—ã
                    userData.balance += gift.value * 3;
                    updateBalance();
                    alert(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${gift.value * 3} üíé –∑–∞ 3 ${gift.name.toLowerCase()}!`);
                    renderGifts();
                    renderInventory();
                    return;
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –ø–æ–¥–∞—Ä–æ–∫ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
            const existingGift = userData.inventory.find(item => item.value === newGiftValue);
            if (existingGift) {
                existingGift.quantity += 1;
            } else {
                userData.inventory.push({
                    id: userData.inventory.length + 1,
                    name: getGiftNameByValue(newGiftValue),
                    value: newGiftValue,
                    quantity: 1
                });
            }

            alert(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ 1 ${getGiftNameByValue(newGiftValue).toLowerCase()}!`);
            renderGifts();
            renderInventory();
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–¥–∞—Ä–∫–∞ –ø–æ —Ü–µ–Ω–Ω–æ—Å—Ç–∏
        function getGiftNameByValue(value) {
            switch (value) {
                case 100: return "–û–±—ã—á–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫";
                case 500: return "–†–µ–¥–∫–∏–π –ø–æ–¥–∞—Ä–æ–∫";
                case 2000: return "–≠–ø–∏—á–µ—Å–∫–∏–π –ø–æ–¥–∞—Ä–æ–∫";
                case 5000: return "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫";
                default: return "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫";
            }
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞
        function openCase(price) {
            if (userData.balance < price) {
                alert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞–ª–º–∞–∑–æ–≤! –ù—É–∂–Ω–æ ${price} üíé`);
                return;
            }

            userData.balance -= price;
            updateBalance();

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è –ø–æ–¥–∞—Ä–∫–æ–≤
            let giftValue;
            const random = Math.random();

            if (price === 100) {
                // –û–±—ã—á–Ω—ã–π –∫–µ–π—Å
                if (random < 0.7) giftValue = 100;   // 70% - –æ–±—ã—á–Ω—ã–π
                else if (random < 0.95) giftValue = 500; // 25% - —Ä–µ–¥–∫–∏–π
                else giftValue = 2000; // 5% - —ç–ø–∏—á–µ—Å–∫–∏–π
            } else if (price === 500) {
                // –†–µ–¥–∫–∏–π –∫–µ–π—Å
                if (random < 0.6) giftValue = 500;   // 60% - —Ä–µ–¥–∫–∏–π
                else if (random < 0.9) giftValue = 2000; // 30% - —ç–ø–∏—á–µ—Å–∫–∏–π
                else giftValue = 5000; // 10% - –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π
            } else if (price === 2000) {
                // –≠–ø–∏—á–µ—Å–∫–∏–π –∫–µ–π—Å
                if (random < 0.5) giftValue = 2000;  // 50% - —ç–ø–∏—á–µ—Å–∫–∏–π
                else giftValue = 5000; // 50% - –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–∞—Ä–æ–∫ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            const existingGift = userData.inventory.find(item => item.value === giftValue);
            if (existingGift) {
                existingGift.quantity += 1;
            } else {
                userData.inventory.push({
                    id: userData.inventory.length + 1,
                    name: getGiftNameByValue(giftValue),
                    value: giftValue,
                    quantity: 1
                });
            }

            alert(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${getGiftNameByValue(giftValue).toLowerCase()}!`);
            renderInventory();
        }

        // –ò–≥—Ä–∞ –≤ —Ä—É–ª–µ—Ç–∫—É
        function playRoulette(price, isTon = false) {
            if (!isTon && userData.balance < price) {
                alert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞–ª–º–∞–∑–æ–≤! –ù—É–∂–Ω–æ ${price} üíé`);
                return;
            }

            if (isTon) {
                // –î–ª—è TON —Ä—É–ª–µ—Ç–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–ª–∞—Ç–µ–∂–Ω–æ–µ –æ–∫–Ω–æ
                showTonPayment();
                document.getElementById('ton-amount').value = 5000; // 5 TON = 5000 –∞–ª–º–∞–∑–æ–≤
                alert('–î–ª—è –∏–≥—Ä—ã –≤ —Å—É–ø–µ—Ä —Ä—É–ª–µ—Ç–∫—É –Ω—É–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å 5 TON');
                return;
            }

            userData.balance -= price;
            updateBalance();

            // –í—Ä–∞—â–∞–µ–º —Ä—É–ª–µ—Ç–∫—É
            const prizes = [
                { value: price * 0.5, text: `${price * 0.5} üíé` },
                { value: price * 1, text: `${price * 1} üíé` },
                { value: price * 2, text: `${price * 2} üíé` },
                { value: price * 5, text: `${price * 5} üíé` },
                { value: 100, text: "–û–±—ã—á–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫" },
                { value: 500, text: "–†–µ–¥–∫–∏–π –ø–æ–¥–∞—Ä–æ–∫" }
            ];

            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–∏–∑
            const prizeIndex = Math.floor(Math.random() * prizes.length);
            const prize = prizes[prizeIndex];

            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—ã–∏–≥—Ä—ã—à
            if (prize.text.includes('üíé')) {
                userData.balance += prize.value;
                updateBalance();
                alert(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${prize.text}`);
            } else {
                const giftValue = prize.value;
                const existingGift = userData.inventory.find(item => item.value === giftValue);
                if (existingGift) {
                    existingGift.quantity += 1;
                } else {
                    userData.inventory.push({
                        id: userData.inventory.length + 1,
                        name: getGiftNameByValue(giftValue),
                        value: giftValue,
                        quantity: 1
                    });
                }
                alert(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${prize.text.toLowerCase()}!`);
                renderInventory();
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞ —á–µ—Ä–µ–∑ TON
        function processTonPayment() {
            const amountInput = document.getElementById('ton-amount');
            const errorElement = document.getElementById('ton-error');

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–≤–æ–¥–∞
            let amount;
            try {
                amount = parseInt(amountInput.value);
                if (isNaN(amount) || amount <= 0) {
                    throw new Error('–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ');
                }
            } catch (e) {
                errorElement.textContent = '–û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ';
                return;
            }

            errorElement.textContent = '';

            // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∞–ª–º–∞–∑—ã –≤ TON (1 TON = 500 –∞–ª–º–∞–∑–æ–≤)
            const tonAmount = amount / 500;

            // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TON Wallet
            // –í –¥–µ–º–æ-–≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –∞–ª–º–∞–∑—ã
            userData.balance += amount;
            updateBalance();

            alert(`–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} –∞–ª–º–∞–∑–æ–≤ (${tonAmount.toFixed(2)} TON)`);
            backToDeposit();

            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–∑–æ–≤ Telegram.WebApp.openInvoice
            /*
            const invoice = {
                amount: tonAmount * 1000000000, // –≤ –Ω–∞–Ω–æ—Ç–æ–Ω–∞—Ö
                currency: 'TON',
                description: `–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ ${amount} –∞–ª–º–∞–∑–æ–≤`
            };

            Telegram.WebApp.openInvoice(invoice, function(status) {
                if (status === 'paid') {
                    userData.balance += amount;
                    updateBalance();
                    alert(`–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} –∞–ª–º–∞–∑–æ–≤!`);
                    backToDeposit();
                } else {
                    alert('–ü–ª–∞—Ç–µ–∂ –Ω–µ –±—ã–ª –∑–∞–≤–µ—Ä—à–µ–Ω');
                }
            });
            */
        }
    </script>
</body>
</html>